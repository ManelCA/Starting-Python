{% extends "base.html" %}

{% block content %}
<div class="card mb-4 p-3 shadow-sm">
  <div class="row g-3 align-items-center">
    <div class="col-auto">
      <img src="{{ user.avatar(128) }}" class="rounded-circle border" alt="User Avatar">
    </div>
    <div class="col">
      <h2 class="mb-1">User: {{ user.username }}</h2>

      {% if user.about_me %}
      <p class="text-muted mb-1">{{ user.about_me }}</p>
      {% endif %}

      {% if user.last_seen %}
      <p class="text-muted">Last seen on: {{ moment(user.last_seen).format('LLL') }}</p>
      {% endif %}

      <p>
        <span class="badge bg-secondary">{{ user.followers_count() }} followers</span>
        <span class="badge bg-secondary">{{ user.following_count() }} following</span>
      </p>

      {% if user == current_user %}
        <a href="{{ url_for('edit_profile') }}" class="btn btn-outline-primary btn-sm">Edit your profile</a>
      {% elif not current_user.is_following(user) %}
        <form action="{{ url_for('follow', username=user.username) }}" method="post" class="d-inline">
          {{ form.hidden_tag() }}
          {{ form.submit(class="btn btn-success btn-sm", value='Follow') }}
        </form>
      {% else %}
        <form action="{{ url_for('unfollow', username=user.username) }}" method="post" class="d-inline">
          {{ form.hidden_tag() }}
          {{ form.submit(class="btn btn-danger btn-sm", value='Unfollow') }}
        </form>
      {% endif %}
    </div>
  </div>
</div>

{% for post in posts %}
  {% include '_post.html' %}
{% endfor %}

<div class="d-flex justify-content-between mt-4">
  {% if prev_url %}
  <a href="{{ prev_url }}" class="btn btn-outline-secondary btn-sm">Newer Posts</a>
  {% endif %}
  {% if next_url %}
  <a href="{{ next_url }}" class="btn btn-outline-secondary btn-sm ms-auto">Older Posts</a>
  {% endif %}
</div>
{% endblock %}
